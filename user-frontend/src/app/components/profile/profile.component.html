<div class="profile-container">
  <div class="profile-header">
    <h1>My Profile</h1>
  </div>

  <div class="profile-content">
    <!-- Tabs -->
    <div class="tabs">
      <button [class.active]="activeTab === 'profile'" (click)="activeTab = 'profile'">
        ğŸ‘¤ Profile
      </button>
      <button [class.active]="activeTab === 'addresses'" (click)="activeTab = 'addresses'">
        ğŸ“ Addresses
      </button>
      <button [class.active]="activeTab === 'security'" (click)="activeTab = 'security'">
        ğŸ”’ Security
      </button>
    </div>

    <!-- Profile Tab -->
    <div *ngIf="activeTab === 'profile'" class="tab-content">
      <div class="profile-card">
        <div class="profile-picture-section">
          <div class="profile-picture">
            <img [src]="profileForm.profilePicture || 'https://via.placeholder.com/150'" alt="Profile">
          </div>
          <input type="file" #fileInput (change)="onImageSelect($event)" accept="image/*" style="display: none;">
          <button class="btn-secondary" (click)="fileInput.click()">Change Picture</button>
        </div>

        <div class="profile-form">
          <div class="form-group">
            <label>Name</label>
            <input type="text" [(ngModel)]="profileForm.name" class="form-control">
          </div>

          <div class="form-group">
            <label>Email</label>
            <input type="email" [(ngModel)]="profileForm.email" class="form-control">
          </div>

          <div class="form-group">
            <label>Phone</label>
            <input type="tel" [(ngModel)]="profileForm.phone" class="form-control">
          </div>

          <button class="btn-primary" (click)="updateProfile()">Save Changes</button>
        </div>
      </div>
    </div>

    <!-- Addresses Tab -->
    <div *ngIf="activeTab === 'addresses'" class="tab-content">
      <div class="addresses-header">
        <h3>Saved Addresses</h3>
        <button class="btn-primary" (click)="openAddressModal()">+ Add New Address</button>
      </div>

      <div *ngIf="addresses.length === 0" class="empty-state">
        <p>No addresses saved yet</p>
      </div>

      <div class="addresses-grid">
        <div *ngFor="let address of addresses" class="address-card" [class.default]="address.isDefault">
          <div class="address-header">
            <h4>{{ address.label }}</h4>
            <span *ngIf="address.isDefault" class="default-badge">Default</span>
          </div>
          <p>{{ address.street }}</p>
          <p>{{ address.city }}, {{ address.state }} {{ address.zipCode }}</p>
          <p>{{ address.country }}</p>
          <p>ğŸ“ {{ address.phone }}</p>
          <div class="address-actions">
            <button class="btn-edit" (click)="openAddressModal(address)">Edit</button>
            <button class="btn-delete" (click)="deleteAddress(address._id)">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Security Tab -->
    <div *ngIf="activeTab === 'security'" class="tab-content">
      <div class="security-card">
        <h3>Change Password</h3>
        
        <div class="form-group">
          <label>Current Password</label>
          <input type="password" [(ngModel)]="passwordForm.currentPassword" class="form-control">
        </div>

        <div class="form-group">
          <label>New Password</label>
          <input type="password" [(ngModel)]="passwordForm.newPassword" class="form-control">
        </div>

        <div class="form-group">
          <label>Confirm New Password</label>
          <input type="password" [(ngModel)]="passwordForm.confirmPassword" class="form-control">
        </div>

        <button class="btn-primary" (click)="changePassword()">Change Password</button>
      </div>
    </div>
  </div>
</div>

<!-- Address Modal -->
<div *ngIf="showAddressModal" class="modal-overlay" (click)="closeAddressModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h3>{{ editingAddress ? 'Edit Address' : 'Add New Address' }}</h3>
    
    <div class="form-group">
      <label>Label</label>
      <select [(ngModel)]="addressForm.label" class="form-control">
        <option value="Home">Home</option>
        <option value="Office">Office</option>
        <option value="Other">Other</option>
      </select>
    </div>

    <div class="form-group">
      <label>Street Address</label>
      <input type="text" [(ngModel)]="addressForm.street" class="form-control">
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>City</label>
        <input type="text" [(ngModel)]="addressForm.city" class="form-control">
      </div>
      <div class="form-group">
        <label>State</label>
        <input type="text" [(ngModel)]="addressForm.state" class="form-control">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Zip Code</label>
        <input type="text" [(ngModel)]="addressForm.zipCode" class="form-control">
      </div>
      <div class="form-group">
        <label>Phone</label>
        <input type="tel" [(ngModel)]="addressForm.phone" class="form-control">
      </div>
    </div>

    <div class="form-group">
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="addressForm.isDefault">
        Set as default address
      </label>
    </div>

    <div class="modal-actions">
      <button class="btn-primary" (click)="saveAddress()">Save</button>
      <button class="btn-secondary" (click)="closeAddressModal()">Cancel</button>
    </div>
  </div>
</div>
